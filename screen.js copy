import fs from "fs";
import path from "path";

const GLITCH = process.env.GLITCH || true;

let lastFile = "";
const fsImageDir = "./public/images";


class Screen {
  constructor(p, canvas, location = 'public/images/'){
    this.counter = 0
    this.location = location
    this.p = p
    this.canvas = canvas
    this.render = GLITCH ? this.display : this.save
  }
  
  display () {
    console.log(this.p.canvas.toDataURL())
  }
  
  save() {
    const fileName = "mySketch" + Date.now();
    this.p.saveCanvas(this.canvas, "public/images/" + fileName, "png").then(
      (filename) => {
        console.log(`saved the canvas as ${filename}`)
        lastFile = fileName;
      }
    )
  }
}

const screen = (p, canvas) => {
  if (GLITCH) {
    console.log("trying to save");
    const fileName = "mySketch" + Date.now();
    p.saveCanvas(canvas, "public/images/" + fileName, "png").then(
      (filename) => {
        console.log(`saved the canvas as ${filename}`);
        lastFile = fileName;
      }
    );
  } else {
    console.log(p.canvas.toDataURL());
  }
};

export default screen;
